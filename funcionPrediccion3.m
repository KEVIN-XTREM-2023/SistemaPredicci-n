function [y1] = funcionPrediccion3(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 17-Jul-2023 16:40:58.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx53 matrix, input #1
% and returns:
%   y = Qx4 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [500;9;12;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1.gain = [4.49438202247191e-05;0.181818181818182;0.0555555555555556;0.5;0.5;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3150135069719783854;0.84875040381072797135;-0.29439668515721179043;-0.073623285522601139563;-0.48215707803309537649;-0.87313475036243604066;1.5534112464268341469];
IW1_1 = [-0.24168033803862928877 -0.45647338488020611225 -0.11194466598065973273 -0.065298697296530650025 2.8436424717860093736 -0.070549951761365720104 -0.11943752621218352294 0.31912667121562865447 -0.00046087412488573018107 -0.24644808647826649262 -0.045085002214246994168 -0.016540987958514514339 -0.023071412053689888816 0.83299589750292435397 0.60249703491237172059 0.67216493399215548887 0.17931376087922248908 -0.17642852692742164167 0.26610821082799418491 0.074823414197898271971 0.21729691948070101182 0.23625829864314340512 -0.19110449990106589957 -0.20478616706291405403 0.040047727171596145257 0.18015933309645817961 -0.23988413228817712097 0.21060468758368550146 -0.31303991364068695091 0.39664477418651639118 0.028136978332073431242 0.26807237745373196924 0.076006730837590852357 0.4138040950213885405 -0.25136206450549153368 0.22339652811703528124 0.091901475577915101023 -0.2173725249005654947 0.38195085414089902098 0.18975199691245023259 -0.13812889996281754734 0.11199681047899030795 0.097707452489239371429 0.038177416187826988814 -0.17044136710891583109 -0.032155246180366706121 0.079632882398333854068 0.10810856241280078494 -0.2741071043960254805 -0.1121154950704207065 -0.27213308238251771032 0.0046954029954818683745 -0.021769861884185563033;-0.31458265927630629788 0.54517996594515105713 -0.16561923485368879039 -0.34425568818807705807 0.59856423015628779094 0.12141677479258811134 0.26221345367945797511 0.11215641905806014722 0.45692521446805517416 -0.059432761470031132689 0.27808538010068123425 0.063717007711535003645 0.074904488550090228549 0.0048507821125243870408 0.55035055960854462054 -0.080337001339872746164 0.14673266157190523185 0.028610796820651939604 0.2694418611167381794 0.066743066441595833016 0.17695545972964091264 0.047324281518349289866 -0.20912940710727812021 -0.38001403833823638179 0.31583880719918328017 0.22702723183182729749 -0.93879959453651251611 1.0816826085861563911 -0.083717456309328933117 0.069138435351836682874 -0.018131964021744825105 -0.16315139447327431377 0.04801375096840672374 0.20329494846472437319 0.0020247540834860380983 0.0071717298322485738271 0.01765840461987986526 -0.015749197122416035144 0.32891262057852871381 -0.10203283406422983259 -0.29647886184714011826 0.30893018252761622611 0.20132988060963441512 0.080851980643504239854 -0.024817882749201821552 -0.01171615297573529689 -0.22068965953210767372 0.14133116373736029359 0.13806211031074683282 0.47688113724128960991 -0.0032421491306522604373 0.3453180227199920127 0.21885235151366957962;5.3486204874520355546 1.9210293914536542559 0.0013685584423739401844 0.0090575214407641897046 -0.49821633343219751122 -0.12367405479860438255 -0.020668482891486966019 -0.047059330888609217369 -0.092992758790015922488 -0.12089170106139726646 -0.32081373220154185688 -0.20810955339597536629 -0.26962015970978236989 0.21770568092251102454 0.082336872170777605784 0.095760036822102170828 -0.098179065425829228908 -0.07922598633474414731 -0.22465865001771756493 -0.19582942179768816904 -0.27954454257571692555 -0.35405401790216650681 -0.19254877262791184056 -0.48066828013781609519 0.047476918773787256389 0.11958916137702196858 -0.14847036208783104261 0.014638956741335033135 -0.21753850501111929305 -0.024250133744454789586 -0.20242997791241715277 -0.010403334764707332372 -0.19921989084662902747 0.026124791350272302121 -0.097590676628101585832 -0.22917330728679141671 -0.43034443100806840654 -0.2270351828813020334 -0.16028033253005527503 -0.0053772309612219165026 -0.36443493443414820554 0.008749177883033474809 -0.24312085912632161455 -0.25522215155542765652 -0.14120380933412268742 -0.12552420769334787787 -0.18126364052990012743 0.11975002291583276837 0.22068024089828608414 0.14586425083122772639 0.14075532919874700344 0.2150586088390878392 0.13854963930402103278;-0.21347311865848228596 -0.041386295705406549172 -0.16363348431780178061 -0.11488110258492008342 -0.57529985777623038334 -0.23322105607273366235 0.37973460501368755393 -0.040780368728986486626 0.20392621336366270612 0.50948360370524692353 -0.34837790406398128074 0.32200730335692123729 0.37094756514043025764 0.421057440894382351 0.19817527500233345084 0.2401468997666134364 -0.38214152072455143117 -0.12973547501080254229 0.024937643893833728176 0.16139019597889694979 0.24040728517964043975 -0.19700941650659423154 -0.15176428080910470131 0.41503540116103260216 -0.347632727913785744 -0.18814985697863792491 -0.65466155558225325173 0.56990457948423178802 -0.035285095012916101176 0.44610257137035386199 0.074362708397761712042 -0.19560397907756621461 0.077206239228165676747 -0.070091407631809210521 0.19572070835786994913 0.37559932749609536984 0.17481191715637145467 0.12928541797825338078 0.3178627823010504172 -0.35529570015890643564 0.5986826505906944762 -0.23605333073127562904 0.088135027011583058631 -0.22573352669589696884 0.39865111822088139526 0.053725570709025664839 0.3818415081486217777 -0.22285238544887658874 0.12220205515763393755 -0.30511667111032220179 0.040690413938656869175 -0.48234376371928316951 -0.10568588391041991437;-0.30513503008845954678 0.27188421413985242037 -0.16162039808011582909 -0.32854939713543390711 0.475480686806120878 -0.19508986510586165397 0.10666447428202828485 0.36478026259574558576 -0.22610310950581999356 0.028432423017168917401 0.99069476222491581474 0.81663459130242577189 0.49505360979046697523 -0.73693919550728614887 -0.15854703354125224135 0.86392962421511299009 -0.20480280815153950602 -0.62420113157510115354 -0.39879641189463149731 -0.15175097044063243223 0.0922988840514461506 0.21697986513355130289 -0.39642331903464150811 0.25904378555858842414 -0.058454587926982735924 0.16116462123781230553 0.11313470775098335985 -0.34956590368834522531 0.2417245907851039155 0.047602158176426691283 -0.063152551635919026984 -0.19886329277364026002 -0.42461816260493001618 -0.061797499814845391342 0.52690781240366313387 -0.26193298140655163486 0.15849926988766221969 0.70399280646994821797 -0.20992239998753375874 0.020876458918393275138 0.027453021593387461757 -0.28803787671657027358 -0.1836690976475119641 0.028255265823516010487 -0.34554434022947527749 -0.057236494841357662966 0.73883793786202145437 0.04404235155973462712 -0.31327087844259782212 -0.31988429256269834688 0.12664128049058220871 0.59547979516885651829 -0.47282405536575011773;0.23082253546503217478 5.2845420984673729947 -0.0024270775846338176265 -0.0052439407016243496512 0.045048282871011091633 0.064882616882796048663 0.015370078262781874945 -0.03462280567011610799 0.035543425241163391359 0.011902987051816634606 -0.086579754598026081869 -0.1135179175656794992 -0.085015646454991419811 0.019509402354287396636 -0.087938391056387080202 -0.086934559818756626526 -0.0067097663501111542983 0.010651756443246826467 -0.094798776931554126768 -0.067697637596612500466 -0.045118265171500415711 -0.085350033171091452266 -0.094206127291334526563 -0.098397766555002902367 0.058340659651462192792 0.053437136318528269396 -0.14386093787882703321 -0.047653711782634521066 -0.18305973740725817178 -0.14248792118349143387 -0.18924963169025244003 -0.12532011940725004684 -0.14937551395880133143 -0.13836744593539107573 -0.20915091519379783169 -0.12445563137302757817 -0.1664904340562817775 -0.19041906840708963666 -0.19456449224960720157 -0.15720875773641046491 -0.24932168174963195706 -0.095640361688985001121 0.0064424803092201403734 -0.016011953157152827854 0.0025765961669154523878 -0.0093472154495296208565 -0.05340994876842914546 0.12310369560099365671 0.19503768111129740626 -0.07223858100668313631 -0.055948721598892428575 -0.25774676437229615544 -0.23286107945903714023;-0.0087976345004182852916 -0.2329326395797281235 -0.32165684805494004772 -0.13485387158909889482 0.0028075203975088235814 -0.19625712085761415349 -0.14264534332559419827 -0.19361404300660850497 0.17113202901104793141 -0.10719909744314697064 0.26228941741021949419 -0.14556548146120973364 0.10132909930973883761 -0.39036654077324300927 -0.052416878435764924227 -0.216312500227954424 0.13970212067434720216 0.057385507116389004867 0.083458154130892900358 0.1121187584806613291 0.18830048444523167506 -0.32545384029185731034 -0.19213842626450181039 -0.26690929393616547038 -0.20160687842157457017 -0.03170821967725307583 -0.060673750300873380281 -0.14912284972436634645 -0.23371462472796847298 -0.23047008371722876863 0.27075562876641046106 -0.23749133032507513397 -0.15921615663872615287 -0.4227280899540598047 0.19801155789432950405 -0.22764956879608380658 -0.13922910299344687379 0.021792624357435112781 0.17213493683508618304 -0.12250837208010162405 0.052839587794206596683 -0.20484396675003052612 0.082125496828699906526 -0.006892164826859706675 -0.21787566687556866873 -0.34900898496593202314 0.11567247031387113687 -0.10942176793402896839 0.13640200261856738617 -0.27985449928555650168 -0.4093118036561551043 -0.1726759653698352881 0.17200750638128856074];

% Layer 2
b2 = [0.56030866659089484383;-1.027269326044037534;-1.3446070480179503903;-0.028668672390014846019];
LW2_1 = [0.21826586580327800302 -0.89613250070998118346 -0.87498140030298865444 -1.263284187008433479 -0.66512007942339046451 0.53067332134147549016 1.2131464943804028955;-0.30573538128708849237 -0.90703131993488073093 -1.731008600989435875 1.1666897627550061323 0.28754636765027996592 7.4718364131249170867 0.2883358206794186529;0.37242754178385917285 0.63792790215213579508 -1.0813912209483340643 1.5739259912821821352 -0.59709162141765070864 -5.7885382833669432046 -1.5483442978707071536;-2.9126337989127946138 -1.3526336595608368096 4.6409320970256890959 -0.71197158231201096434 -0.40520422917033932508 -0.25497097634096327345 -1.3037785754705115693];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
